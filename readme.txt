教材用XAudio2サウンドドライバver 0.0.0 by kawatanik

■概要
サウンドプログラミングの入り口に立つための教材用として作った、シンプルなサウンドドライバです。
Windows上でのXAudio2を用いたドライバです。したがって動作環境はWindows XP以降、DirectX 9以降です。
ほかの環境は想定していませんがXbox系なら動くかもしれません。ただしサポート対象外です。

特記の無い場合はC++11 + STLで書かれています。
Visual Studioでビルドすることしか想定していないため、ほかのビルドシステムでの使用はサポート対象外です。
なお、C++11を使っているのでVisual Studioは2013以降のみの対応です。

あくまでも教材用であり実用は考慮していないので、チュートリアル用途以外の使用は非推奨です。サポートもしません。
特に、クラス構成回りは実用性より読みやすさやサウンドプログラムの初歩のわかりやすさを重視しているので、
実用化するなら求められるスペックやツール作成も考慮した上でクラス設計からやり直したほうがいいです。
あとメモリが断片化し放題なのでこのままに近い形で使うならせめてアロケータを導入したほうがいいと思います。


■ver 0.0.0について
ファイルを食わせたら音が鳴るだけです。オブジェクト管理すらありません。
今後クラス構成がガラッと変わる可能性があります。


■ファイル / クラス
util/macros_debug.h
デバッグマクロを定義してるだけです。あまり気にしなくていいです。


Drv.h / Drv.cpp
サウンドドライバ本体。グローバル関数でできています。


class Core(Core.h / Core.cpp)
XAudio2のエンジン管理およびマスタリングボイス管理のクラスです。
シングルトンです。


class Master(Master.h / Master.cpp)
マスタートラッククラス予定地です(未実装)。


class Bus(Bus.h / Bus.cpp)
出力バスクラス予定地です(未実装)。


class Snd(Snd.h / Snd.cpp)
音源オブジェクトクラスです。
オンメモリ再生のみです。
ストリーミングは子クラスにするか統合するか悩み中です。


class SndCallback(SndCallback.h / SndCallback.cpp)
音源オブジェクト用コールバッククラスです。


class TrackBase(TrackBase.cpp / TrackBase.h)
トラックの基底クラスです。
Master、Bus、Sndはこのクラスを継承します。
チャンネルストリップに必要な機能はここに乗る予定です。


class Wave(Wave.cpp / Wave.h)
Waveファイルアクセサです。
指定ファイル名のWaveファイルを読んで、波形バッファやフォーマットを返してくれます。
単なるファイルパーサなので、サウンドドライバの理解という意味ではこのクラスは読まなくてもいいです。
ちなみに内部で無名メモリマップトファイルとしてマッピングしているので、
オンメモリ再生をジャストインタイムロードで疑似ストリーミングにできます。



■今後の実装予定
 - BusクラスおよびMasterクラスの実装
 - オブジェクト管理の実装
 - Waveファイルのsmplチャンクのパースとsmplチャンクを用いたループ処理
 - Waveファイルの非圧縮以外のフォーマット対応
 - ストリーミング再生の実装
 - エフェクトチェインの実装
 - エフェクトインターフェイスラッパの実装